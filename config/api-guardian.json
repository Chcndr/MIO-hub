{
  "version": 3,
  "last_updated": "2025-11-24T12:00:00Z",
  "risk_levels": ["low", "medium", "high"],
  "rules": {
    "always_require_confirmation_for": [
      "mihub.deploy.vercel",
      "github.repo.file.upsert"
    ],
    "log_every_call": true,
    "log_channel": "api-guardian",
    "auto_log_patterns": [
      "mihub.*",
      "github.*",
      "admin.secrets.*"
    ],
    "write_log_to": {
      "type": "database",
      "target": "mio_agent_logs",
      "fallback": {
        "type": "file",
        "target": "logs/api-guardian.log"
      }
    },
    "agent_restrictions": {
      "mio": {
        "forbidden_endpoints": [
          "github.repo.file.upsert",
          "mihub.deploy.vercel",
          "admin.secrets.*"
        ],
        "forbidden_actions": [
          "PUT on GitHub repos",
          "Deploy operations",
          "Database migrations"
        ]
      },
      "manus_worker": {
        "forbidden_endpoints": [
          "github.repo.file.upsert",
          "mihub.deploy.vercel",
          "admin.secrets.*"
        ],
        "forbidden_actions": [
          "PUT on GitHub repos",
          "Deploy operations",
          "Database migrations",
          "Code modifications"
        ]
      },
      "gemini_arch": {
        "allowed_modes": ["read"],
        "forbidden_actions": [
          "Any write operation"
        ]
      },
      "dev": {
        "allowed_endpoints": [
          "github.repo.contents",
          "github.repo.file.upsert",
          "mihub.tasks.list",
          "mihub.tasks.create",
          "mihub.orchestrator.run",
          "mihub.deploy.vercel",
          "logs.createLog",
          "logs.getLogs"
        ],
        "require_confirmation_for": [
          "github.repo.file.upsert",
          "mihub.deploy.vercel"
        ]
      }
    }
  },
  "ui": {
    "show_in_dashboard": true,
    "sections": {
      "endpoints": {
        "source": "api/index.json"
      },
      "permissions": {
        "source": "agents/permissions.json"
      },
      "logs": {
        "enabled": true,
        "source": "database",
        "endpoint": "/api/logs/getLogs"
      },
      "debug": {
        "enabled": true,
        "endpoint": "/api/guardian/debug/testEndpoint"
      }
    }
  },
  "logging": {
    "schema": {
      "table": "mio_agent_logs",
      "fields": [
        "id",
        "timestamp",
        "agent",
        "serviceId",
        "endpoint",
        "method",
        "statusCode",
        "risk",
        "success",
        "message",
        "meta_json"
      ]
    },
    "endpoints": {
      "initSchema": "/api/logs/initSchema",
      "createLog": "/api/logs/createLog",
      "getLogs": "/api/logs/getLogs"
    }
  }
}
